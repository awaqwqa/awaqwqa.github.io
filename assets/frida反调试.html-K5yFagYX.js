import{_ as n}from"./plugin-vue_export-helper-x3n3nnut.js";import{o as s,c as a,e}from"./app-aC0TAnwp.js";const t={},p=e(`<h1 id="frida的反调试" tabindex="-1"><a class="header-anchor" href="#frida的反调试" aria-hidden="true">#</a> frida的反调试</h1><blockquote><p>这里学习到的 我们调试一个程序的时候 我们首先要获取它的包名<br>提前声明这里实战 只是为了学习 学习经验()</p></blockquote><h2 id="实战" tabindex="-1"><a class="header-anchor" href="#实战" aria-hidden="true">#</a> 实战</h2><h3 id="获取包名" tabindex="-1"><a class="header-anchor" href="#获取包名" aria-hidden="true">#</a> 获取包名</h3><ul><li>这里看教程大概就是 去找到AndroidMainfest.xml文件 然后搜索<code>package=xxxx</code>这个xxxx就是包的名字 <ul><li>这里我们拿到包名字:<code>com.netease.x19</code></li></ul></li></ul><h3 id="hook-一个测试脚本" tabindex="-1"><a class="header-anchor" href="#hook-一个测试脚本" aria-hidden="true">#</a> hook 一个测试脚本</h3><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Java<span class="token punctuation">.</span><span class="token function">enumerateLoadedClasses</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token function-variable function">onMatch</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> handler</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>name<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">&quot;com.netease.x19&quot;</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> clz <span class="token operator">=</span> Java<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> methods <span class="token operator">=</span> clz<span class="token punctuation">.</span>class<span class="token punctuation">.</span><span class="token function">getDeclaredMethods</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> methods<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;name:&quot;</span><span class="token punctuation">,</span> name<span class="token punctuation">,</span> <span class="token string">&quot;methods:&quot;</span><span class="token punctuation">,</span> methods<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token function-variable function">onComplete</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token function">setImmediate</span><span class="token punctuation">(</span>
    <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;test&quot;</span><span class="token punctuation">)</span>
        Java<span class="token punctuation">.</span><span class="token function">perform</span><span class="token punctuation">(</span>main<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>然后</li><li>我们执行指令</li></ul><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>frida <span class="token parameter variable">-U</span> <span class="token parameter variable">-f</span> com.netease.x19 <span class="token parameter variable">-l</span> hook.js --no-pause
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><blockquote><p>然后发生报错:<br></p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>usage: frida <span class="token punctuation">[</span>options<span class="token punctuation">]</span> target
frida: error: unrecognized arguments: --no-pause
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p><br>这里搜了去 发现frida在新版本中移除了--no-pause 所以我们就不带这个了</p></blockquote><ul><li><p>执行完上面的hook指令后发现了报错</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>Failed to spawn<span class="token operator">:</span> need Gadget to attach on jailed Android<span class="token punctuation">;</span> its <span class="token keyword">default</span> location is<span class="token operator">:</span> <span class="token constant">C</span><span class="token operator">:</span>\\Users\\<span class="token number">61428</span>\\AppData\\Local\\Microsoft\\Windows\\INetCache\\frida\\gadget<span class="token operator">-</span>android<span class="token operator">-</span>arm64<span class="token punctuation">.</span>so
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>然后搜索发现是我修改了默认的端口号为<code>11451</code> 所以我带上参数:<code>-H 127.0.0.1:11451</code></li></ul><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>frida <span class="token operator">-</span><span class="token constant">H</span> <span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token operator">:</span><span class="token number">11451</span> <span class="token operator">-</span>f com<span class="token punctuation">.</span>netease<span class="token punctuation">.</span>x19 <span class="token operator">-</span>l hook<span class="token punctuation">.</span>js 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>执行成功</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>     ____
    / _  <span class="token operator">|</span>   Frida <span class="token number">16.1</span>.8 - A world-class dynamic instrumentation toolkit
   <span class="token operator">|</span> <span class="token punctuation">(</span>_<span class="token operator">|</span> <span class="token operator">|</span>
    <span class="token operator">&gt;</span> _  <span class="token operator">|</span>   Commands:
   /_/ <span class="token operator">|</span>_<span class="token operator">|</span>       <span class="token builtin class-name">help</span>      -<span class="token operator">&gt;</span> Displays the <span class="token builtin class-name">help</span> system
   <span class="token builtin class-name">.</span> <span class="token builtin class-name">.</span> <span class="token builtin class-name">.</span> <span class="token builtin class-name">.</span>       object?   -<span class="token operator">&gt;</span> Display information about <span class="token string">&#39;object&#39;</span>
   <span class="token builtin class-name">.</span> <span class="token builtin class-name">.</span> <span class="token builtin class-name">.</span> <span class="token builtin class-name">.</span>       exit/quit -<span class="token operator">&gt;</span> Exit
   <span class="token builtin class-name">.</span> <span class="token builtin class-name">.</span> <span class="token builtin class-name">.</span> <span class="token builtin class-name">.</span>
   <span class="token builtin class-name">.</span> <span class="token builtin class-name">.</span> <span class="token builtin class-name">.</span> <span class="token builtin class-name">.</span>   More info at https://frida.re/docs/home/
   <span class="token builtin class-name">.</span> <span class="token builtin class-name">.</span> <span class="token builtin class-name">.</span> <span class="token builtin class-name">.</span>
   <span class="token builtin class-name">.</span> <span class="token builtin class-name">.</span> <span class="token builtin class-name">.</span> <span class="token builtin class-name">.</span>   Connected to <span class="token number">127.0</span>.0.1:11451 <span class="token punctuation">(</span>id<span class="token operator">=</span>socket@127.0.0.1:11451<span class="token punctuation">)</span>
Spawned <span class="token variable"><span class="token variable">\`</span>com.netease.x19<span class="token variable">\`</span></span><span class="token builtin class-name">.</span> Resuming main thread<span class="token operator">!</span>
<span class="token punctuation">[</span>Remote::com.netease.x19 <span class="token punctuation">]</span>-<span class="token operator">&gt;</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>然后我们得到了一堆数据 太多了 这里放不下 接下来我们需要筛选(留着后天来写)</p></li></ul>`,11),o=[p];function c(l,i){return s(),a("div",null,o)}const d=n(t,[["render",c],["__file","frida反调试.html.vue"]]);export{d as default};
